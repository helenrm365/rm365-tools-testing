<!-- Inventory Adjustments Page -->
<div class="inventory-adjustments">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Stock Adjustments</h1>
      <p class="page-subtitle">Scan barcodes to quickly update inventory levels across all locations</p>
    </div>
  </div>

  <!-- Navigation Tabs -->
  <div class="inner-tabs">
    <button class="tab-button" onclick="location.href='/inventory/management'">
      <i class="fas fa-boxes"></i>
      <span>Management</span>
    </button>
    <button class="tab-button active" onclick="location.href='/inventory/adjustments'">
      <i class="fas fa-sliders-h"></i>
      <span>Adjustments</span>
    </button>
  </div>

  <!-- Main Content Wrapper -->
  <div class="adjustments-wrapper">
    <!-- Primary Section -->
    <div class="adjustments-section">
      <!-- Scanner Section -->
      <div class="scanner-section">
        <div class="section-header">
          <div class="section-icon">
            <i class="fas fa-barcode"></i>
          </div>
          <div class="section-title-group">
            <h3 class="section-title">Scanner-Ready Adjustments</h3>
            <p class="section-subtitle">Click anywhere to activate scanner input</p>
          </div>
        </div>

        <!-- Scanner Interface Card -->
        <div class="scanner-interface-card">
          <div class="scanner-status-badge">
            <i class="fas fa-check-circle"></i>
            <span>Ready to Scan</span>
          </div>

          <!-- Form Grid -->
          <div class="form-grid">
            <!-- Barcode Input -->
            <div class="form-field">
              <label class="form-label">
                <i class="fas fa-barcode"></i>
                Barcode/SKU
              </label>
              <input type="text" id="barcodeInput" class="modern-input barcode-input" placeholder="Scan or type barcode...">
              <div id="scanStatus" class="status-message"></div>
            </div>

            <!-- Quantity -->
            <div class="form-field">
              <label class="form-label">
                <i class="fas fa-hashtag"></i>
                Qty
              </label>
              <input type="number" id="quantityInput" class="modern-input qty-input" value="1" min="1">
            </div>

            <!-- Reason Dropdown -->
            <div class="form-field">
              <label class="form-label">
                <i class="fas fa-clipboard-list"></i>
                Reason
              </label>
              <div class="c-select" id="reasonDropdown" aria-expanded="false">
                <button type="button" class="c-select__button" id="reasonToggle" aria-haspopup="listbox" aria-expanded="false">
                  <span class="c-select__label">Pick/Pack</span>
                  <svg class="c-select__caret" width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <ul class="c-select__list" role="listbox">
                  <li class="c-select__item" role="option" data-value="pick_pack" data-type="out">Pick/Pack</li>
                  <li class="c-select__item" role="option" data-value="received" data-type="in">Received</li>
                  <li class="c-select__item" role="option" data-value="damaged" data-type="out">Damaged</li>
                  <li class="c-select__item" role="option" data-value="returned" data-type="in">Returned</li>
                  <li class="c-select__item" role="option" data-value="lost" data-type="out">Lost</li>
                  <li class="c-select__item" role="option" data-value="found" data-type="in">Found</li>
                  <li class="c-select__item" role="option" data-value="correction" data-type="correction">Correction</li>
                </ul>
              </div>
            </div>

            <!-- Field Dropdown -->
            <div class="form-field">
              <label class="form-label">
                <i class="fas fa-map-marker-alt"></i>
                Location
              </label>
              <div class="c-select" id="fieldDropdown" aria-expanded="false">
                <button type="button" class="c-select__button" id="fieldToggle" aria-haspopup="listbox" aria-expanded="false">
                  <span class="c-select__label">Shelf < 1</span>
                  <svg class="c-select__caret" width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <ul class="c-select__list" role="listbox">
                  <li class="c-select__item" role="option" data-value="shelf_lt1_qty">Shelf < 1 Year</li>
                  <li class="c-select__item" role="option" data-value="shelf_gt1_qty">Shelf > 1 Year</li>
                  <li class="c-select__item" role="option" data-value="top_floor_total">Top Floor</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="action-buttons">
            <button id="submitBtn" class="action-btn primary-btn">
              <i class="fas fa-check-circle"></i>
              Submit Adjustment
            </button>
            
            <div class="checkbox-group">
              <input type="checkbox" id="autoSubmit" checked>
              <label for="autoSubmit">Auto-submit on scan</label>
            </div>
          </div>

          <!-- Status Message -->
          <div id="statusMessage" class="status-message"></div>
        </div>
      </div>
    </div>

    <!-- Sidebar Section -->
    <div class="sidebar-section">
      <!-- Recent Adjustments Card -->
      <div class="info-card">
        <h4 class="info-card-title">
          <i class="fas fa-history"></i>
          Recent Adjustments
        </h4>
        <div class="table-container" id="recentAdjustmentsTable" style="max-height: 400px;">
          <p class="empty-state" style="padding: 2rem; text-align: center; color: #999;">Recent adjustments will appear here...</p>
        </div>
      </div>

      <!-- Tips Section -->
      <div class="info-card tips-section">
        <h4 class="info-card-title">
          <i class="fas fa-lightbulb"></i>
          How It Works
        </h4>
        <ul>
          <li><strong>Manual Selection Required:</strong> When scanning items, you must manually select which location to affect using the "Location" dropdown (Shelf < 1 Year, Shelf > 1 Year, or Top Floor).</li>
          <li><strong>Best Practice:</strong> When picking/packing orders, prioritize taking from "Shelf < 1 Year" first to ensure older stock is used before expiration.</li>
          <li><strong>Smart Shelf Logic:</strong> When removing stock from Shelf < 1 Year:
            <ul style="margin-top: 0.5rem;">
              <li>If Shelf < 1 Year quantity is insufficient, the system automatically takes from Shelf > 1 Year</li>
              <li>If Shelf > 1 Year is also insufficient, it takes from Top Floor</li>
              <li>This ensures FIFO (First In, First Out) inventory management</li>
            </ul>
          </li>
          <li><strong>Adjustment Types:</strong>
            <ul style="margin-top: 0.5rem;">
              <li><em>Outbound</em> (Pick/Pack, Damaged, Lost) will <strong>reduce</strong> inventory</li>
              <li><em>Inbound</em> (Received, Returned, Found) will <strong>add</strong> to inventory</li>
              <li><em>Correction</em> allows manual adjustment in either direction</li>
            </ul>
          </li>
          <li><strong>Real-time Updates:</strong> All changes are applied immediately to the local inventory database.</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- Global Dropdown Backdrop -->
<div id="globalDropdownBackdrop" class="dropdown-backdrop"></div>

<!-- Universal Footer -->
<div id="footerPlaceholder"></div>
<script>
  if (!document.getElementById('universalFooter')) {
    fetch('/components/universal-footer.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('footerPlaceholder').innerHTML = html;
      })
      .catch(error => console.error('Error loading footer:', error));
  }
</script>
