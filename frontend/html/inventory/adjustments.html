<!-- Inventory Adjustments Page -->
<div class="inventory-adjustments">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Stock Adjustments</h1>
      <p class="page-subtitle">Scan barcodes to quickly update inventory levels across all locations</p>
    </div>
  </div>

  <!-- Navigation Tabs -->
  <div class="inner-tabs">
    <button class="tab-button" onclick="location.href='/inventory/management'">
      <i class="fas fa-boxes"></i>
      <span>Management</span>
    </button>
    <button class="tab-button active" onclick="location.href='/inventory/adjustments'">
      <i class="fas fa-sliders-h"></i>
      <span>Adjustments</span>
    </button>
    <button class="tab-button" onclick="location.href='/inventory/magento'">
      <i class="fas fa-shopping-cart"></i>
      <span>Pick & Pack</span>
    </button>
  </div>

  <!-- Main Content Wrapper -->
  <div class="adjustments-wrapper">
    <!-- Primary Section -->
    <div class="adjustments-section">
      <!-- Scanner Section -->
      <div class="scanner-section">
        <div class="section-header">
          <div class="section-icon">
            <i class="fas fa-barcode"></i>
          </div>
          <div class="section-title-group">
            <h3 class="section-title">Scanner-Ready Adjustments</h3>
            <p class="section-subtitle">Click anywhere to activate scanner input</p>
          </div>
        </div>

        <!-- Scanner Interface Card -->
        <div class="scanner-interface-card">
          <div class="scanner-status-badge">
            <i class="fas fa-check-circle"></i>
            <span>Ready to Scan</span>
          </div>

          <!-- Form Grid -->
          <div class="form-grid">
            <!-- Barcode Input -->
            <div class="form-field">
              <label class="form-label">
                <i class="fas fa-barcode"></i>
                Barcode/SKU
              </label>
              <input type="text" id="barcodeInput" class="modern-input barcode-input" placeholder="Scan or type barcode...">
              <div id="scanStatus" class="status-message"></div>
            </div>

            <!-- Quantity -->
            <div class="form-field">
              <label class="form-label">
                <i class="fas fa-hashtag"></i>
                Qty
              </label>
              <input type="number" id="quantityInput" class="modern-input qty-input" value="1" min="1">
            </div>

            <!-- Reason Dropdown -->
            <div class="form-field">
              <label class="form-label">
                <i class="fas fa-clipboard-list"></i>
                Reason
              </label>
              <div class="c-select" id="reasonDropdown" aria-expanded="false">
                <button type="button" class="c-select__button" id="reasonToggle" aria-haspopup="listbox" aria-expanded="false">
                  <span class="c-select__label">Pick/Pack</span>
                  <svg class="c-select__caret" width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <ul class="c-select__list" role="listbox">
                  <li class="c-select__item" role="option" data-value="pick_pack" data-type="out">Pick/Pack</li>
                  <li class="c-select__item" role="option" data-value="received" data-type="in">Received</li>
                  <li class="c-select__item" role="option" data-value="damaged" data-type="out">Damaged</li>
                  <li class="c-select__item" role="option" data-value="returned" data-type="in">Returned</li>
                  <li class="c-select__item" role="option" data-value="lost" data-type="out">Lost</li>
                  <li class="c-select__item" role="option" data-value="found" data-type="in">Found</li>
                  <li class="c-select__item" role="option" data-value="correction" data-type="correction">Correction</li>
                </ul>
              </div>
            </div>

            <!-- Field Dropdown -->
            <div class="form-field">
              <label class="form-label">
                <i class="fas fa-map-marker-alt"></i>
                Location
              </label>
              <div class="c-select" id="fieldDropdown" aria-expanded="false">
                <button type="button" class="c-select__button" id="fieldToggle" aria-haspopup="listbox" aria-expanded="false">
                  <span class="c-select__label">Auto (Smart)</span>
                  <svg class="c-select__caret" width="10" height="6" viewBox="0 0 10 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <ul class="c-select__list" role="listbox">
                  <li class="c-select__item" role="option" data-value="auto">Auto (Smart Logic)</li>
                  <li class="c-select__item" role="option" data-value="shelf_lt1_qty">Shelf < 1 Year</li>
                  <li class="c-select__item" role="option" data-value="shelf_gt1_qty">Shelf > 1 Year</li>
                  <li class="c-select__item" role="option" data-value="top_floor_total">Top Floor</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="action-buttons">
            <button id="submitBtn" class="action-btn primary-btn">
              <i class="fas fa-check-circle"></i>
              Submit Adjustment
            </button>
            
            <div class="checkbox-group">
              <input type="checkbox" id="autoSubmit" checked>
              <label for="autoSubmit">Auto-submit on scan</label>
            </div>
          </div>

          <!-- Status Message -->
          <div id="statusMessage" class="status-message"></div>
        </div>
      </div>
    </div>

    <!-- Sidebar Section -->
    <div class="sidebar-section">
      <!-- Recent Adjustments Card -->
      <div class="info-card">
        <h4 class="info-card-title">
          <i class="fas fa-history"></i>
          Recent Adjustments
        </h4>
        <div class="table-container" id="recentAdjustmentsTable" style="max-height: 400px;">
          <p class="empty-state" style="padding: 2rem; text-align: center; color: #999;">Recent adjustments will appear here...</p>
        </div>
      </div>

      <!-- How to Use Guide -->
      <div class="info-card guide-card">
        <div class="instructions-header">
          <div class="instructions-icon">
            <i class="fas fa-info-circle"></i>
          </div>
          <h4 class="instructions-title">How to Use</h4>
        </div>
        
        <div class="steps-list">
          <div class="step-item">
            <div class="step-number">1</div>
            <div class="step-info">
              <div class="step-name">
                <i class="fas fa-clipboard-list step-icon"></i>
                Select Reason
              </div>
              <p class="step-desc">Choose adjustment type (Pick/Pack, Received, etc.)</p>
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">2</div>
            <div class="step-info">
              <div class="step-name">
                <i class="fas fa-map-marker-alt step-icon"></i>
                Choose Location
              </div>
              <p class="step-desc">Select specific shelf or Auto for smart logic</p>
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">3</div>
            <div class="step-info">
              <div class="step-name">
                <i class="fas fa-barcode step-icon"></i>
                Scan Barcode
              </div>
              <p class="step-desc">Scan item or enter barcode manually</p>
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">4</div>
            <div class="step-info">
              <div class="step-name">
                <i class="fas fa-hashtag step-icon"></i>
                Set Quantity
              </div>
              <p class="step-desc">Enter amount to adjust (default: 1)</p>
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">5</div>
            <div class="step-info">
              <div class="step-name">
                <i class="fas fa-check-circle step-icon"></i>
                Submit
              </div>
              <p class="step-desc">Press Enter or click Submit to log adjustment</p>
            </div>
          </div>
        </div>
      </div>

      <!-- System Logic Guide -->
      <div class="info-card guide-card">
        <div class="instructions-header">
          <div class="instructions-icon logic-icon">
            <i class="fas fa-cogs"></i>
          </div>
          <h4 class="instructions-title">System Logic</h4>
        </div>
        
        <div class="logic-items">
          <div class="logic-item">
            <div class="logic-icon-wrapper">
              <i class="fas fa-random"></i>
            </div>
            <div class="logic-content">
              <h5>Auto Mode (Pick/Pack Only)</h5>
              <p>Smart FIFO logic: Takes from Shelf &lt;1 → Shelf &gt;1 → Top Floor automatically</p>
            </div>
          </div>
          
          <div class="logic-item">
            <div class="logic-icon-wrapper">
              <i class="fas fa-crosshairs"></i>
            </div>
            <div class="logic-content">
              <h5>Specific Location Mode</h5>
              <p>Adjusts only the selected location. Fails if insufficient stock available.</p>
            </div>
          </div>
          
          <div class="logic-item">
            <div class="logic-icon-wrapper">
              <i class="fas fa-exchange-alt"></i>
            </div>
            <div class="logic-content">
              <h5>Adjustment Types</h5>
              <p><strong>Out:</strong> Pick/Pack, Damaged, Lost<br>
              <strong>In:</strong> Received, Returned, Found<br>
              <strong>Correction:</strong> Manual +/-</p>
            </div>
          </div>
          
          <div class="logic-item">
            <div class="logic-icon-wrapper">
              <i class="fas fa-sync-alt"></i>
            </div>
            <div class="logic-content">
              <h5>Real-time Updates</h5>
              <p>All adjustments update inventory immediately and sync live across all users.</p>
            </div>
          </div>
        </div>
        
        <div class="note-card">
          <i class="fas fa-exclamation-circle"></i>
          <span><strong>Note:</strong> Zero quantity adjustments are ignored automatically.</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Global Dropdown Backdrop -->
<div id="globalDropdownBackdrop" class="dropdown-backdrop"></div>

<!-- Universal Footer -->
<div id="footerPlaceholder"></div>
<script>
  if (!document.getElementById('universalFooter')) {
    fetch('/components/universal-footer.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('footerPlaceholder').innerHTML = html;
      })
      .catch(error => console.error('Error loading footer:', error));
  }
</script>
